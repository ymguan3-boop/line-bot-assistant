# LINE æ™ºèƒ½åŠ©æ‰‹æ©Ÿå™¨äºº

æ•´åˆè¡Œç¨‹ç®¡ç†ã€è¨˜å¸³åŠŸèƒ½èˆ‡å°è©±ç´€éŒ„è½‰å¯„çš„ LINE Botã€‚

## åŠŸèƒ½ç‰¹è‰²

âœ¨ **è¡Œç¨‹ç®¡ç†**
- æ–°å¢é‡å¤§è¡Œç¨‹
- æŸ¥è©¢ç‰¹å®šæ—¥æœŸå€é–“çš„è¡Œç¨‹
- æŸ¥çœ‹æ‰€æœ‰è¡Œç¨‹åˆ—è¡¨

ğŸ’° **è¨˜å¸³åŠŸèƒ½**
- è¨˜éŒ„æ—¥å¸¸èŠ±è²»
- åˆ†é¡çµ±è¨ˆ(é£²é£Ÿã€äº¤é€šã€å¨›æ¨‚ç­‰)
- æŸ¥è©¢æœ¬æœˆ/æœ¬é€±/ä»Šæ—¥èŠ±è²»

ğŸ“§ **å°è©±è½‰å¯„**
- è¼¸å…¥ä»»æ„ Email å³å¯è½‰å¯„
- åŒ…å«å®Œæ•´å°è©±ç´€éŒ„
- è‡ªå‹•é™„å¸¶ä¸Šå‚³çš„æª”æ¡ˆ
- ç²¾ç¾çš„ HTML æ ¼å¼å ±è¡¨

ğŸ¤– **æ™ºèƒ½å›æ‡‰**
- é—œéµå­—è‡ªå‹•å›æ‡‰
- å‹å–„çš„å°è©±ä»‹é¢

## å®‰è£æ­¥é©Ÿ

### 1. è¤‡è£½å°ˆæ¡ˆ

```bash
git clone https://github.com/ymguan3-boop/line-bot-assistant.git
cd line-bot-assistant
```

### 2. å®‰è£ä¾è³´

```bash
npm install
```

### 3. è¨­å®šç’°å¢ƒè®Šæ•¸

è¤‡è£½ `.env.example` ç‚º `.env`:

```bash
cp .env.example .env
```

ç·¨è¼¯ `.env` å¡«å…¥ä½ çš„è¨­å®š:

```env
CHANNEL_ACCESS_TOKEN=ä½ çš„_LINE_Token
CHANNEL_SECRET=ä½ çš„_LINE_Secret
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=ä½ çš„Email
SMTP_PASS=ä½ çš„Emailå¯†ç¢¼
PORT=3000
```

### 4. å•Ÿå‹•æœå‹™

```bash
npm start
```

### 5. ä½¿ç”¨ ngrok æ¸¬è©¦

é–‹æ–°çµ‚ç«¯è¦–çª—:

```bash
ngrok http 3000
```

## LINE è¨­å®š

1. å‰å¾€ [LINE Developers Console](https://developers.line.biz/console/)
2. è¨­å®š Webhook URL: `https://ä½ çš„ngrokç¶²å€/webhook`
3. é–‹å•Ÿ "Use webhook"
4. é—œé–‰ "Auto-reply messages"
5. æƒæ QR Code åŠ å…¥å¥½å‹

## ä½¿ç”¨æ–¹å¼

### åŸºæœ¬æŒ‡ä»¤

- `åŠŸèƒ½` - é¡¯ç¤ºåŠŸèƒ½é¸å–®
- `ä½ å¥½` - æ‰“æ‹›å‘¼
- `å–æ¶ˆ` - å–æ¶ˆç›®å‰æ“ä½œ

### è¡Œç¨‹ç®¡ç†

**æ–°å¢è¡Œç¨‹:**
```
ä½ : æ–°å¢è¡Œç¨‹
Bot: ğŸ“… è«‹è¼¸å…¥è¡Œç¨‹æ¨™é¡Œ
ä½ : éƒ¨é–€æœƒè­°
Bot: ğŸ“… è«‹è¼¸å…¥æ—¥æœŸ
ä½ : 2026/01/15
Bot: ğŸ“ è«‹è¼¸å…¥æè¿°
ä½ : è¨è«–å¹´åº¦ç›®æ¨™
Bot: âœ… è¡Œç¨‹å·²æ–°å¢!
```

**æŸ¥è©¢è¡Œç¨‹:**
```
ä½ : æŸ¥è©¢è¡Œç¨‹
Bot: è«‹è¼¸å…¥æŸ¥è©¢æ—¥æœŸå€é–“
ä½ : 2026/01/01 - 2026/01/31
æˆ–
ä½ : æœ¬æœˆ
Bot: ğŸ“… é¡¯ç¤ºè¡Œç¨‹åˆ—è¡¨
```

**æŸ¥çœ‹æ‰€æœ‰è¡Œç¨‹:**
```
ä½ : æ‰€æœ‰è¡Œç¨‹
Bot: ğŸ“… é¡¯ç¤ºæ‰€æœ‰è¡Œç¨‹
```

### è¨˜å¸³åŠŸèƒ½

**è¨˜å¸³:**
```
ä½ : è¨˜å¸³
Bot: ğŸ’° è«‹è¼¸å…¥æ¶ˆè²»é …ç›®
ä½ : åˆé¤
Bot: ğŸ’° è«‹è¼¸å…¥é‡‘é¡
ä½ : 150
Bot: ğŸ“‚ è«‹é¸æ“‡é¡åˆ¥
ä½ : 1
Bot: âœ… èŠ±è²»å·²è¨˜éŒ„!
```

**æŸ¥è©¢èŠ±è²»:**
```
ä½ : æŸ¥è©¢èŠ±è²»
Bot: è«‹é¸æ“‡æŸ¥è©¢æ–¹å¼
     1. æœ¬æœˆèŠ±è²»
     2. æœ¬é€±èŠ±è²»
     3. ä»Šæ—¥èŠ±è²»
     4. è‡ªè¨‚æ—¥æœŸå€é–“
ä½ : 1
Bot: ğŸ’° é¡¯ç¤ºæœ¬æœˆèŠ±è²»æ˜ç´°
```

**èŠ±è²»çµ±è¨ˆ:**
```
ä½ : èŠ±è²»çµ±è¨ˆ
Bot: ğŸ“Š æœ¬æœˆèŠ±è²»çµ±è¨ˆ
     é£²é£Ÿ: NT$ 2,100 (60%)
     äº¤é€š: NT$ 800 (22.9%)
     å¨›æ¨‚: NT$ 600 (17.1%)
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     ğŸ’° ç¸½è¨ˆ: NT$ 3,500
     ğŸ“ ç­†æ•¸: 15 ç­†
```

### å°è©±è½‰å¯„

```
ä½ : è½‰å¯„å°è©±
Bot: ğŸ“§ è«‹è¼¸å…¥æ”¶ä»¶è€… Email
ä½ : example@gmail.com
Bot: âœ… å°è©±ç´€éŒ„å·²æˆåŠŸå¯„é€åˆ°: example@gmail.com
```

è½‰å¯„çš„éƒµä»¶å°‡åŒ…å«:
- å®Œæ•´å°è©±ç´€éŒ„
- æ‰€æœ‰è¡Œç¨‹åˆ—è¡¨
- èŠ±è²»çµ±è¨ˆå ±è¡¨
- ä¸Šå‚³çš„æ‰€æœ‰é™„ä»¶

## SMTP è¨­å®šæŒ‡å—

### Gmail

1. å•Ÿç”¨å…©æ­¥é©Ÿé©—è­‰
2. ç”¢ç”Ÿæ‡‰ç”¨ç¨‹å¼å¯†ç¢¼: https://myaccount.google.com/apppasswords
3. è¨­å®š:
```env
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=ä½ çš„Gmail@gmail.com
SMTP_PASS=æ‡‰ç”¨ç¨‹å¼å¯†ç¢¼(16ä½)
```

### Outlook/Hotmail

```env
SMTP_HOST=smtp.office365.com
SMTP_PORT=587
SMTP_USER=ä½ çš„Outlookå¸³è™Ÿ
SMTP_PASS=ä½ çš„Outlookå¯†ç¢¼
```

### Yahoo

```env
SMTP_HOST=smtp.mail.yahoo.com
SMTP_PORT=587
SMTP_USER=ä½ çš„Yahooå¸³è™Ÿ
SMTP_PASS=æ‡‰ç”¨ç¨‹å¼å¯†ç¢¼
```

## éƒ¨ç½²åˆ° Render

### 1. å»ºç«‹å¸³è™Ÿ

å‰å¾€ [Render](https://render.com) è¨»å†Š

### 2. é€£æ¥ GitHub

- é»æ“Š "New +" â†’ "Web Service"
- é¸æ“‡ "Connect a repository"
- æˆæ¬Šä¸¦é¸æ“‡ `line-bot-assistant`

### 3. è¨­å®š

```
Name: line-bot-assistant
Environment: Node
Build Command: npm install
Start Command: npm start
```

### 4. ç’°å¢ƒè®Šæ•¸

åœ¨ "Environment" é é¢æ–°å¢:

```
CHANNEL_ACCESS_TOKEN = ä½ çš„LINE Token
CHANNEL_SECRET = ä½ çš„LINE Secret
SMTP_HOST = smtp.gmail.com
SMTP_PORT = 587
SMTP_USER = ä½ çš„Email
SMTP_PASS = ä½ çš„Emailå¯†ç¢¼
```

### 5. éƒ¨ç½²

é»æ“Š "Create Web Service"ï¼Œç­‰å¾…éƒ¨ç½²å®Œæˆ

### 6. æ›´æ–° LINE Webhook

éƒ¨ç½²å®Œæˆå¾Œæœƒå¾—åˆ°ç¶²å€ï¼Œä¾‹å¦‚:
```
https://line-bot-assistant.onrender.com
```

å›åˆ° LINE Developers Console æ›´æ–° Webhook URL:
```
https://line-bot-assistant.onrender.com/webhook
```

## è³‡æ–™çµæ§‹

å°ˆæ¡ˆæœƒè‡ªå‹•å»ºç«‹ä»¥ä¸‹ç›®éŒ„:

```
line-bot-assistant/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ conversations.json  # å°è©±ç´€éŒ„
â”‚   â”œâ”€â”€ events.json         # è¡Œç¨‹ç´€éŒ„
â”‚   â””â”€â”€ expenses.json       # èŠ±è²»ç´€éŒ„
â”œâ”€â”€ attachments/            # ä¸Šå‚³çš„é™„ä»¶
â”œâ”€â”€ server.js               # ä¸»ç¨‹å¼
â”œâ”€â”€ package.json            # å°ˆæ¡ˆè¨­å®š
â”œâ”€â”€ .env                    # ç’°å¢ƒè®Šæ•¸(ä¸ä¸Šå‚³)
â”œâ”€â”€ .env.example            # ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
â”œâ”€â”€ .gitignore              # Git å¿½ç•¥æ¸…å–®
â”œâ”€â”€ Procfile                # éƒ¨ç½²è¨­å®š
â””â”€â”€ README.md               # èªªæ˜æ–‡ä»¶
```

### conversations.json æ ¼å¼

```json
[
  {
    "id": "message_id",
    "time": "2026/1/8 ä¸‹åˆ2:30:00",
    "timestamp": 1704700200000,
    "user": "å¼µä¸‰",
    "userId": "U1234567890",
    "type": "text",
    "content": "ä½ å¥½"
  }
]
```

### events.json æ ¼å¼

```json
[
  {
    "id": 1704700300000,
    "user": "å¼µä¸‰",
    "userId": "U1234567890",
    "title": "éƒ¨é–€æœƒè­°",
    "date": "2026/01/15",
    "description": "è¨è«–Q1ç›®æ¨™",
    "createdAt": "2026/1/8 ä¸‹åˆ2:35:00"
  }
]
```

### expenses.json æ ¼å¼

```json
[
  {
    "id": 1704700400000,
    "user": "å¼µä¸‰",
    "userId": "U1234567890",
    "item": "åˆé¤",
    "amount": 150,
    "category": "é£²é£Ÿ",
    "date": "2026/1/8",
    "datetime": "2026/1/8 ä¸‹åˆ2:40:00"
  }
]
```

## æŠ€è¡“æ¶æ§‹

- **Node.js 18+** - JavaScript åŸ·è¡Œç’°å¢ƒ
- **Express** - Web æ¡†æ¶
- **@line/bot-sdk** - LINE Messaging API SDK
- **Nodemailer** - SMTP éƒµä»¶ç™¼é€
- **dotenv** - ç’°å¢ƒè®Šæ•¸ç®¡ç†

## åŠŸèƒ½æµç¨‹åœ–

```
ä½¿ç”¨è€…ç™¼é€è¨Šæ¯
    â†“
æ¥æ”¶ Webhook äº‹ä»¶
    â†“
åˆ¤æ–·è¨Šæ¯é¡å‹
    â”œâ”€ æ–‡å­—è¨Šæ¯
    â”‚   â†“
    â”‚   æª¢æŸ¥ç”¨æˆ¶ç‹€æ…‹
    â”‚   â”œâ”€ åœ¨æ“ä½œæµç¨‹ä¸­ â†’ è™•ç†æµç¨‹è¼¸å…¥
    â”‚   â””â”€ ä¸€èˆ¬ç‹€æ…‹ â†’ è§£ææŒ‡ä»¤
    â”‚       â†“
    â”‚       åŸ·è¡Œå°æ‡‰åŠŸèƒ½
    â”‚       â”œâ”€ æ–°å¢è¡Œç¨‹
    â”‚       â”œâ”€ æŸ¥è©¢è¡Œç¨‹
    â”‚       â”œâ”€ è¨˜å¸³
    â”‚       â”œâ”€ æŸ¥è©¢èŠ±è²»
    â”‚       â”œâ”€ èŠ±è²»çµ±è¨ˆ
    â”‚       â”œâ”€ è½‰å¯„å°è©±
    â”‚       â””â”€ ä¸€èˆ¬å›æ‡‰
    â”‚
    â””â”€ é™„ä»¶è¨Šæ¯
        â†“
        ä¸‹è¼‰ä¸¦å„²å­˜é™„ä»¶
        â†“
        è¨˜éŒ„åˆ° conversations.json
        â†“
        å›æ‡‰ç”¨æˆ¶
```

## å¸¸è¦‹å•é¡Œ

### 1. Bot æ²’æœ‰å›æ‡‰?

æª¢æŸ¥é …ç›®:
- âœ… ä¼ºæœå™¨æ˜¯å¦æ­£åœ¨é‹è¡Œ
- âœ… Webhook URL æ˜¯å¦æ­£ç¢º
- âœ… LINE "Use webhook" æ˜¯å¦é–‹å•Ÿ
- âœ… LINE "Auto-reply" æ˜¯å¦é—œé–‰
- âœ… ç’°å¢ƒè®Šæ•¸æ˜¯å¦æ­£ç¢ºè¨­å®š

### 2. éƒµä»¶ç„¡æ³•ç™¼é€?

æª¢æŸ¥é …ç›®:
- âœ… SMTP è¨­å®šæ˜¯å¦æ­£ç¢º
- âœ… Email å¸³è™Ÿå¯†ç¢¼æ˜¯å¦æ­£ç¢º
- âœ… Gmail éœ€ä½¿ç”¨æ‡‰ç”¨ç¨‹å¼å¯†ç¢¼
- âœ… é˜²ç«ç‰†æ˜¯å¦é˜»æ“‹ SMTP é€£ç·š

### 3. è³‡æ–™æ²’æœ‰å„²å­˜?

æª¢æŸ¥é …ç›®:
- âœ… `data` ç›®éŒ„æ˜¯å¦å­˜åœ¨
- âœ… JSON æª”æ¡ˆæ˜¯å¦æœ‰å¯«å…¥æ¬Šé™
- âœ… ç£ç¢Ÿç©ºé–“æ˜¯å¦å……è¶³

### 4. Render éƒ¨ç½²å¤±æ•—?

å¸¸è¦‹åŸå› :
- âŒ ç’°å¢ƒè®Šæ•¸æœªè¨­å®š
- âŒ Node.js ç‰ˆæœ¬ä¸ç¬¦
- âŒ Build Command éŒ¯èª¤

è§£æ±ºæ–¹æ³•:
```
ç¢ºèª package.json ä¸­æœ‰:
"engines": {
  "node": ">=18.0.0"
}
```

## é–‹ç™¼å»ºè­°

### æœ¬åœ°é–‹ç™¼

```bash
# å®‰è£ nodemon è‡ªå‹•é‡å•Ÿ
npm install -g nodemon

# ä½¿ç”¨ dev æ¨¡å¼
npm run dev
```

### æ¸¬è©¦å»ºè­°

1. å…ˆåœ¨æœ¬åœ°æ¸¬è©¦æ‰€æœ‰åŠŸèƒ½
2. ç¢ºèª ngrok webhook æ­£å¸¸é‹ä½œ
3. å†éƒ¨ç½²åˆ° Render
4. éƒ¨ç½²å¾Œé‡æ–°æ¸¬è©¦ä¸€æ¬¡

### è³‡æ–™å‚™ä»½

å®šæœŸå‚™ä»½ `data/` è³‡æ–™å¤¾:

```bash
# æ‰‹å‹•å‚™ä»½
cp -r data data_backup_$(date +%Y%m%d)

# æˆ–ä½¿ç”¨ git
git add data/
git commit -m "Backup data"
```

## æˆæ¬Š

MIT License

## ä½œè€…

ymguan3-boop

## è²¢ç»

æ­¡è¿æäº¤ Pull Request æˆ–é–‹ Issue å›å ±å•é¡Œ!

## è¯çµ¡æ–¹å¼

å¦‚æœ‰å•é¡Œè«‹é–‹ GitHub Issue

---

**äº«å—ä½¿ç”¨ LINE æ™ºèƒ½åŠ©æ‰‹! ğŸ¤–âœ¨**
